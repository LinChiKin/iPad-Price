<!DOCTYPE html>
<html lang="zh-Hant" xml:lang="zh-Hant">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta name="Description" content="Enter your description here"/>
        <title>JS-iPad Air AJAX練習</title>
        <!--Bootstrap CSS-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <!--Font Awesome-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <!--SweetAlert2 CSS-->
        <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.min.css" rel="stylesheet">
        <!--Server CSS Imports-->
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <!--Local CSS-->
        <style>
            /* For Testing */
            .bd1{
                border:1px solid blue;
            }
            .bd2{
                border:1px solid red;
            }
            .bd3{
                border:1px solid green;
            }
            .bd4{
                border:1px solid yellow;
            }
            /* Content */
            .h6{
                font-size: 12px;
            }
            .gray-text{
                color:gray;
            }
            .cyan-text{
                color:rgb(27, 98, 221);
            }
            .section-btn{
                position: relative;
            }
            .section-bar{
                position: absolute;
                top: 30px;
                left: -30%;
                width:130%;
                background-color: white;
                z-index: 100;
                border:1px solid black;
            }
            .section-bar a{
                padding: 3px;
                display:block;
            }
            /* Ajustment */
            @media screen and (width<1000px){
                #row1{
                    display:flex;
                    flex-direction: column;
                }
                #content{
                    width:100%;
                }
                #img1{
                    width:600px;
                }
            }
        </style>
    </head>
    <body>
        
        <div class="container mt-5">
            <div class="row" id="row1">
                <div class="col-5 d-flex flex-column justify-content-center" id="img1">
                    <picture>
                        <div id="carouselId" class="carousel slide" data-bs-ride="carousel">
                            <ol class="carousel-indicators">
                                <li data-bs-target="#carouselId" data-bs-slide-to="0" class="active" aria-current="true" aria-label="First slide"></li>
                                <li data-bs-target="#carouselId" data-bs-slide-to="1" aria-label="Second slide"></li>
                                <li data-bs-target="#carouselId" data-bs-slide-to="2" aria-label="Third slide"></li>
                                <li data-bs-target="#carouselId" data-bs-slide-to="3" aria-label="Fourth slide"></li>
                            </ol>
                            <div class="carousel-inner" role="listbox">
                                <div class="carousel-item active">
                                    <img src="https://fakeimg.pl/2560x1440/200" class="w-100 d-block" alt="First slide" id="pic-1">
                                </div>
                                <div class="carousel-item">
                                    <img src="https://fakeimg.pl/2560x1440/230" class="w-100 d-block" alt="Second slide" id="pic-2">
                                </div>
                                <div class="carousel-item">
                                    <img src="https://fakeimg.pl/2560x1440/666" class="w-100 d-block" alt="Third slide" id="pic-3">
                                </div>
                                <div class="carousel-item">
                                    <img src="https://fakeimg.pl/2560x1440/666" class="w-100 d-block" alt="Fourth slide" id="pic-4">
                                </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselId" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselId" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </picture>
                </div>
                <div class="col-7" id="content">
                    <div class="row">
                        <div class="col pb-3">
                            <h1><strong>購買 iPad Air</strong></h1>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col d-flex justify-content-between">
                            <h3>
                                <span class="w3-badge w3-red me-4">1</span>
                                <b id="selection1">
                                    顏色
                                </b>
                            </h3>
                            <div class="text-decoration-none align-self-center cyan-text section-btn" id="section-btn1">
                                Change
                                <div class="section-bar" id="section-bar1">
                                    <a id="section-bar1-opt1">Awaiting</a>
                                    <a id="section-bar1-opt2">Awaiting</a>
                                    <a id="section-bar1-opt3">Awaiting</a>
                                    <a id="section-bar1-opt4">Awaiting</a>
                                    <a id="section-bar1-opt5">Awaiting</a>
                                </div>
                            </div>  
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col d-flex justify-content-between">
                            <h3>
                                <span class="w3-badge w3-red me-4">2</span>
                                <b id="selection2">
                                    儲存裝置
                                </b>
                            </h3>
                            <div class="text-decoration-none align-self-center cyan-text section-btn" id="section-btn2">
                                Change
                                <div class="section-bar" id="section-bar2">
                                    <a id="section-bar2-opt1">Awaiting</a>
                                    <a id="section-bar2-opt2">Awaiting</a>
                                </div>
                            </div>   
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col d-flex justify-content-between">
                            <h3>
                                <span class="w3-badge w3-red me-4">3</span>
                                <b id="selection3">
                                    連線能力
                                </b>
                            </h3>
                            <div class="text-decoration-none align-self-center cyan-text section-btn" id="section-btn3">
                                Change
                                <div class="section-bar" id="section-bar3">
                                    <a id="section-bar3-opt1">Awaiting</a>
                                    <a id="section-bar3-opt2">Awaiting</a>
                                </div>
                            </div>   
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-8 m-auto">
                            <h1><strong>NT$<span id="price"></span></strong></h1>
                            <h6 class="mb-4 gray-text">含營業稅和其他法定税費：約NT$1,368</h6>
                            <h6 class="cyan-text">每月 NT$2,350起12</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>        





        <!------------------------------------------------------------------------------------------------------>
        <!--JQuery JS-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
        <!--Bootstrap JS-->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
        <!--SweetAlert2 JS-->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.3/dist/sweetalert2.all.min.js"></script>
        <!--Server JS Imports-->
        
        <!--Local JS-->
        <script> //Public
            //Variables
            let mem="";
            let net="";
            let data="";
            let price=0;
            //Functions
            function open_file(format,path,timeout_sec){
                this.result="Awaiting";
                let request=new XMLHttpRequest();
                request.onload=()=>{
                    try{
                        console.log("Request from ",path," : Response Received ! (2/3)");
                        if(format=="txt"){ //String
                            this.result=request.responseText;
                        }
                        else if (format=="json"){ //Object
                            this.result=JSON.parse(request.responseText);
                        }
                        else if (format=="xml"){ //XML Object
                            this.result=request.responseXML;
                        }
                        else if (format=="blob"){ //Blob Object
                            this.result=request.response;
                        }
                        else{
                            throw "error";
                        }
                        console.log("Request from ",path," : Process Accomplish ! (3/3)");
                    }
                    catch(error){
                        console.log("Request from ",path," : Data Transform Error !");
                        this.result="Error";
                    }
                };
                request.onprogress=()=>{
                    console.log("Request from ",path," : Request Sent ! (1/3)");
                };
                request.ontimeout=()=>{
                    request.abort();
                    this.result="Aborted";
                    console.log("Request from ",path," : Timeout ! Request Aborted !");
                };
                request.onerror=()=>{
                    console.log("Request from ",path," : Error !");
                    this.result="Error";
                }
                this.abort=()=>{
                    request.abort();
                    this.result="Aborted";
                    console.log("Request from ",path," : User Request Aborted !");
                }
                if(format=="blob"){
                    request.responseType="blob";
                }
                request.timeout=timeout_sec;
                request.open("GET",path);
                request.send();
            };
            function present_price(){
                try{
                    price=0;
                    let mem_arr=data.capacity.filter((i)=>{return i.option==mem});
                    let net_arr=data.network_capability.filter((i)=>{return i.option==net});
                    price=net_arr[0].price+mem_arr[0].price;
                    console.log(price);
                    $("#price").hide();
                    $("#price").html(price);
                    $("#price").show(1000);
                }
                catch(error){
                    console.log("one choice left");
                }
            }
            function set_color(num){
                $("#selection1").html(data.color[num].option);
                $("#pic-1").attr("src",data.color[num].url_front);
                $("#pic-2").attr("src",data.color[num].url_back);
                $("#pic-3").attr("src",data.color[num].url_alter);
                $("#pic-4").attr("src",data.color[num].url_whole_back);
            }
            //Event Listeners
            $("#section-btn1").click(()=>{
                $("#section-bar1").slideToggle(500);
            });
            $("#section-btn2").click(()=>{
                $("#section-bar2").slideToggle(500);
            });
            $("#section-btn3").click(()=>{
                $("#section-bar3").slideToggle(500);
            });
            $("#section-bar1-opt1").click(()=>{
                set_color(0);
            });
            $("#section-bar1-opt2").click(()=>{
                set_color(1);
            });
            $("#section-bar1-opt3").click(()=>{
                set_color(2);
            });
            $("#section-bar1-opt4").click(()=>{
                set_color(3);
            });
            $("#section-bar1-opt5").click(()=>{
                set_color(4);
            });
            $("#section-bar2-opt1").click(()=>{
                $("#selection2").html(data.capacity[0].option);
                mem=data.capacity[0].option;
                present_price();
            });
            $("#section-bar2-opt2").click(()=>{
                $("#selection2").html(data.capacity[1].option);
                mem=data.capacity[1].option;
                present_price();
            });
            $("#section-bar3-opt1").click(()=>{
                $("#selection3").html(data.network_capability[0].option);
                net=data.network_capability[0].option;
                present_price();
            });
            $("#section-bar3-opt2").click(()=>{
                $("#selection3").html(data.network_capability[1].option);
                net=data.network_capability[1].option;
                present_price();
            });
            window.onload=()=>{
                $("#section-bar1").slideToggle(500);
                $("#section-bar2").slideToggle(500);
                $("#section-bar3").slideToggle(500);
                let jsons=new open_file("json","https://raw.githubusercontent.com/LinChiKin/iPad.json/master/iPad.json",3000);
                setTimeout(()=>{
                    data=jsons.result;
                    console.log(data);
                    $("#section-bar1-opt1").html(data.color[0].option);
                    $("#section-bar1-opt2").html(data.color[1].option);
                    $("#section-bar1-opt3").html(data.color[2].option);
                    $("#section-bar1-opt4").html(data.color[3].option);
                    $("#section-bar1-opt5").html(data.color[4].option);
                    $("#section-bar2-opt1").html(data.capacity[0].option);
                    $("#section-bar2-opt2").html(data.capacity[1].option);
                    $("#section-bar3-opt1").html(data.network_capability[0].option);
                    $("#section-bar3-opt2").html(data.network_capability[1].option); 
                },1000);
            };
        </script>
    </body>
</html>